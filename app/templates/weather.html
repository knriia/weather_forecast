<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã</title>
    <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>
    <main class="container">
        {% if city_name %}
        <section class="weather-header">
            <h1>–ü–æ–≥–æ–¥–∞ –≤ {{ city_name }}</h1>
            <p class="subtitle">{{ display_name }}</p>
        </section>
        {% endif %}

        <section class="weather-grid">
            {% if weather_data %}
                {% for weather in weather_data %}
                <article class="weather-card">
                    <h3>{{ weather.date }}</h3>
                    <div class="weather-metrics">
                        <span>üå° {{ weather.temperature_2m_mean | round(1) }}¬∞C</span>
                        <span>üíß {{ weather.precipitation_probability_mean | round(1) }}%</span>
                    </div>
                    <p class="weather-code">{{ weather.weather_code }}</p>
                </article>
                {% endfor %}
            {% else %}
                <p class="no-data">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</p>
            {% endif %}
        </section>

        <section class="weather-form">
            <form method="POST">
                <div class="form-group">
                    <label for="city_name">–ì–æ—Ä–æ–¥</label>
                    <input
                        type="text"
                        id="city_name"
                        name="city_name"
                        value="{{ city_name }}"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="forecast_days">–î–Ω–µ–π –ø—Ä–æ–≥–Ω–æ–∑–∞</label>
                    <input
                        type="number"
                        id="forecast_days"
                        name="forecast_days"
                        min="1"
                        max="14"
                        value="{{ forecast_days }}"
                        required
                    >
                </div>

                <button type="submit" class="submit-btn">–ü–æ–∫–∞–∑–∞—Ç—å</button>

                {% if error %}
                <p class="error-message">{{ error }}</p>
                {% endif %}
            </form>
        </section>
    </main>
<div class="history-section">
    <h3>–í–∞—à–∞ –∏—Å—Ç–æ—Ä–∏—è –ø–æ–∏—Å–∫–∞</h3>
    <ul id="history-list">
        {% for item in history %}
        <li>
            {{ item.city }} ({{ item.days }} –¥–Ω–µ–π) - {{ item.timestamp }}
        </li>
        {% endfor %}
    </ul>
</div>

<script>
    // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —á–µ—Ä–µ–∑ API
    async function loadStats() {
        const response = await fetch("/api/stats");
        const data = await response.json();
        console.log("–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:", data);
        // –ú–æ–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
    }

    // –í—ã–∑—ã–≤–∞–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    loadStats();
</script>
</body>
</html>